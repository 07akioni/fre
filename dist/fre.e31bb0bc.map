{"version":3,"sources":["src/patch.js","src/hooks.js","src/html.js","src/h.js","src/render.js","src/index.js","index.js"],"names":["fns","patch","parent","dom","oldVnode","vnode","type","newDom","create","insertBefore","nodeValue","update","props","oldKeyed","newKeyed","oldDom","oldChildren","children","forEach","child","i","childNodes","oldKey","key","n","length","newKey","filterFn","document","createElement","name","setAttrs","createTextNode","appendChild","oldProps","cloneProps","node","value","String","match","toLowerCase","tagName","toUpperCase","setAttribute","style","cssText","obj","walk","Object","keys","f","arr","golbal","oldTree","newTree","once","c","useState","state","call","proxy","newState","Proxy","get","set","val","console","log","Error","e","stack","CACHE","TEMPLATE","reg","html","statics","tpl","build","arguments","str","innerHTML","replace","a","s","trim","Function","content","firstChild","nodeType","data","field","nodeName","localName","sub","start","attributes","substring","nextSibling","sep","matches","strValue","JSON","stringify","h","htm","bind","render","el","setTimeout","_render","counter","count","body"],"mappings":"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","file":"fre.e31bb0bc.map","sourceRoot":"..","sourcesContent":["export let fns\r\n\r\nexport function patch(parent, dom, oldVnode, vnode) {\r\n  if (oldVnode === vnode) {\r\n  } else if (oldVnode === null || oldVnode.type !== vnode.type) {\r\n    let newDom = create(vnode)\r\n    parent.insertBefore(newDom, dom)\r\n    dom = newDom\r\n  } else if (oldVnode.type === null) {\r\n    dom.nodeValue = vnode\r\n  } else {\r\n    update(dom, oldVnode.props, vnode.props)\r\n\r\n    let oldKeyed = {}\r\n    let newKeyed = {}\r\n\r\n    let oldDom = []\r\n    let oldChildren = oldVnode.children\r\n    let children = vnode.children\r\n\r\n    oldChildren.forEach(child => {\r\n      oldDom[i] = dom.childNodes[i]\r\n\r\n      let oldKey = child.key\r\n      if (oldKey) {\r\n        oldKeyed[oldKey] = [oldDom[i], child]\r\n      }\r\n    })\r\n\r\n    let n = 0\r\n\r\n    while (n < children.length) {\r\n      let oldKey = oldChildren[n].key\r\n      let newKey = children[n].key\r\n\r\n      if (!newKey || !oldKey) {\r\n        patch(dom, oldDom[n], oldChildren[n], children[n])\r\n        n++\r\n      } else {\r\n        newKeyed[newKey] = children[n]\r\n        n++\r\n      }\r\n    }\r\n  }\r\n  return dom\r\n}\r\n\r\nexport function create(vnode) {\r\n  fns = filterFn(vnode)\r\n\r\n  if (typeof vnode.type === 'function') {\r\n    vnode = vnode.type(vnode.props)\r\n  }\r\n  let dom = document.createElement(vnode.type)\r\n  for (let name in vnode.props) {\r\n    setAttrs(dom, name, vnode.props[name])\r\n  }\r\n  vnode.children.forEach(child => {\r\n    child =\r\n      typeof child == 'object' ? create(child) : document.createTextNode(child)\r\n    dom.appendChild(child)\r\n  })\r\n\r\n  return dom\r\n}\r\n\r\nfunction update(dom, oldProps, props) {\r\n  let cloneProps = { ...oldProps, ...props }\r\n  for (let name in cloneProps) {\r\n    setAttrs(dom, name, cloneProps[name])\r\n  }\r\n}\r\n\r\nfunction setAttrs(node, name, value) {\r\n  switch (name) {\r\n    case String(name.match(/on\\w+/)):\r\n      name = name.toLowerCase()\r\n      node[name] = value || ''\r\n      break\r\n    case 'className':\r\n      name === 'class'\r\n      break\r\n    case 'key':\r\n      break\r\n    case 'value':\r\n      if (\r\n        node.tagName.toUpperCase() === 'INPUT' ||\r\n        node.tagName.toUpperCase() === 'TEXTAREA'\r\n      ) {\r\n        node.value = value\r\n      } else {\r\n        node.setAttribute(name, value)\r\n      }\r\n      break\r\n    case 'style':\r\n      node.style.cssText = value\r\n      break\r\n    default:\r\n      node.setAttribute(name, value)\r\n  }\r\n}\r\n\r\nfunction filterFn(obj) {\r\n  let fns = {}\r\n  return walk(obj, fns)\r\n}\r\n\r\nfunction walk(obj, fns) {\r\n  if (obj) {\r\n    Object.keys(obj).forEach(i => {\r\n      if (i === 'type') {\r\n        let f = obj[i]\r\n        if (typeof f === 'function') {\r\n          fns[f.name] = obj\r\n        }\r\n      } else if (i === 'children') {\r\n        let arr = obj[i]\r\n        arr.forEach(child => {\r\n          walk(child, fns)\r\n        })\r\n      }\r\n    })\r\n  }\r\n  return fns\r\n}\r\n","import { fns,dom } from './patch'\r\n\r\nlet golbal = {}\r\nlet oldTree\r\nlet newTree\r\nlet once = true\r\n\r\nlet c\r\n\r\nexport function useState(state) {\r\n  if (Object.keys(golbal).length > 0) {\r\n    state = {\r\n      ...state,\r\n      ...golbal\r\n    }\r\n  }\r\n  // counter\r\n  if (once) {\r\n    c = fns[call()]\r\n    once = false\r\n  }\r\n  return proxy(state)\r\n}\r\n\r\nfunction proxy(state) {\r\n  let newState = new Proxy(state, {\r\n    get(obj, key) {\r\n      if (golbal[key]) {\r\n        return golbal[key]\r\n      } else {\r\n        return obj[key]\r\n      }\r\n    },\r\n    set(obj, key, val) {\r\n      golbal[key] = val\r\n      obj[key] = val\r\n      let vnode = c.type() //新的 vnode\r\n\r\n      console.log(vnode)\r\n\r\n      \r\n      return true\r\n    }\r\n  })\r\n\r\n  return newState\r\n}\r\n\r\nfunction call() {\r\n  try {\r\n    throw new Error()\r\n  } catch (e) {\r\n    try {\r\n      return e.stack.match(/Object.(\\S*)/)[1]\r\n    } catch (e) {\r\n      return ''\r\n    }\r\n  }\r\n}\r\n","// complie tagged template to vnode , thanks htm\r\n\r\nconst CACHE = {}\r\nconst TEMPLATE = document.createElement('template')\r\nconst reg = /(\\$_h\\[\\d+\\])/g\r\n\r\nexport default function html(statics) {\r\n  const tpl = CACHE[statics] || (CACHE[statics] = build(statics))\r\n  return tpl(this, arguments)\r\n}\r\n\r\nfunction build(statics) {\r\n  let str = statics[0],\r\n    i = 1\r\n  while (i < statics.length) {\r\n    str += '$_h[' + i + ']' + statics[i++]\r\n  }\r\n  TEMPLATE.innerHTML = str\r\n    .replace(/<(?:(\\/)\\/|(\\/?)(\\$_h\\[\\d+\\]))/g, '<$1$2c c@=$3')\r\n    .replace(/<([\\w:-]+)(?:\\s[^<>]*?)?(\\/?)>/g,(str, name, a) => str.replace(/(?:'.*?'|\".*?\"|([A-Z]))/g, (s, c) => (c ? ':::' + c : s)) + (a ? '</' + name + '>' : ''))\r\n    .replace(/[\\r\\n]|\\ \\ +/g,'')\r\n    .trim()\r\n\r\n  return Function('h','$_h','return ' + walk((TEMPLATE.content || TEMPLATE).firstChild))\r\n}\r\n\r\nfunction walk(n) {\r\n  if (n.nodeType != 1) {\r\n    if (n.nodeType == 3 && n.data) return field(n.data, ',')\r\n    return 'null'\r\n  }\r\n\r\n  let str = '',\r\n    nodeName = field(n.localName, str),\r\n    sub = '',\r\n    start = ',({'\r\n\r\n  for (let i = 0; i < n.attributes.length; i++) {\r\n    const name = n.attributes[i].name\r\n    const value = n.attributes[i].value\r\n\r\n    if (name == 'c@') {\r\n      nodeName = value\r\n    } else if (name.substring(0,3) == '...') {\r\n      sub = ''\r\n      start = ',Object.assign({'\r\n      str += '},' + name.substring(3) + ',{'\r\n    } else {\r\n      str += `${sub}\"${name.replace(/:::(\\w)/g, (s, i) => i.toUpperCase())}\":${value ? field(value, '+') : true}`\r\n      sub = ','\r\n    }\r\n  }\r\n\r\n  str = 'h(' + nodeName + start + str + '})'\r\n  let child = n.firstChild\r\n  while (child) {\r\n    str += ',' + walk(child)\r\n    child = child.nextSibling\r\n  }\r\n\r\n  return str + ')'\r\n}\r\n\r\nfunction field(value, sep) {\r\n  const matches = value.match(reg)\r\n  let strValue = JSON.stringify(value)\r\n  \r\n  if (matches != null) {\r\n    if (matches[0] === value) return value\r\n    strValue = strValue.replace(reg, `\"${sep}$1${sep}\"`).replace(/\"[+,]\"/g, '')\r\n    if (sep == ',') strValue = `[${strValue}]`\r\n  }\r\n\r\n  return strValue\r\n}\r\n","import htm from './html'\r\n\r\nexport function h(type, props, ...children) {\r\n  return {\r\n    type,\r\n    props,\r\n    key: props.key || null,\r\n    children\r\n  }\r\n}\r\n\r\nexport const html = htm.bind(h)\r\n","import { create, patch } from './patch'\r\n\r\nexport function render(vnode, el) {\r\n  setTimeout(_render(vnode, el), 0)\r\n}\r\n\r\nfunction _render(vnode, el) {\r\n  let dom = patch(el, null, null, vnode)\r\n  console.log(dom)\r\n}\r\n","import { useState } from './hooks'\r\nimport { html, h } from './h'\r\nimport { render } from './render'\r\n\r\nexport { useState, html, h, render }\r\n","import { render, html, useState } from './src'\r\n\r\nfunction counter() {\r\n  const state = useState({\r\n    count: 0\r\n  })\r\n\r\n  return html`\r\n    <div>\r\n      <p>${state.count}</p>\r\n      <button onclick=${() => {state.count++}}>+</button>\r\n      <button onclick=${() => {state.count--}}>-</button>\r\n    </div>\r\n  `\r\n}\r\n\r\nrender(html`<${counter} />`, document.body)\r\n"]}