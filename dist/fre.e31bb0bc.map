{"version":3,"sources":["src/patch.js","src/render.js","src/hooks.js","src/html.js","src/h.js","src/index.js","index.js"],"names":["comps","patch","parent","element","oldVnode","vnode","console","log","c","insertBefore","create","type","props","update","reusableChildren","oldElements","newKeys","i","children","length","oldElement","childNodes","oldChild","oldKey","key","j","newChild","newKey","reusableChild","removeChild","reusableNode","replaceChild","document","createTextNode","createElement","forEach","child","appendChild","name","setAttrs","dom","oldProps","cloneProps","node","value","String","match","toLowerCase","tagName","toUpperCase","setAttribute","style","cssText","render","vdom","el","filterFn","fns","rerender","comp","setTimeout","obj","walk","Object","keys","f","arr","golbal","once","useState","state","proxy","newState","Proxy","get","set","val","Error","e","stack","CACHE","TEMPLATE","reg","html","statics","tpl","build","arguments","str","innerHTML","replace","a","s","trim","Function","content","firstChild","n","nodeType","data","field","nodeName","localName","sub","start","attributes","substring","nextSibling","sep","matches","strValue","JSON","stringify","h","htm","bind","counter","count","sex","body"],"mappings":"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","file":"fre.e31bb0bc.map","sourceRoot":"..","sourcesContent":["//这个方法就是，第一次渲染的时候，parent 是根节点，然后 parent 就变成 element 了\nexport var comps\n\nexport function patch(parent, element, oldVnode, vnode) {\n  console.log(c())\n  if (oldVnode == null) {\n    //首次渲染，将node 的 dom 插到 body 下\n    element = parent.insertBefore(create(vnode), element)\n  } else if (vnode.type && vnode.type === oldVnode.type) {\n    //标签相同，就更新属性，但是如果都是function的话，那就没办法\n    if (typeof vnode.type === 'function') {\n      vnode = vnode.type(vnode.props)\n      oldVnode = oldVnode.type(oldVnode.props)\n      patch(parent, element, oldVnode, vnode)\n    }\n    update(element, oldVnode.props, vnode.props) //更新属性\n\n    var reusableChildren = {} //可以复用的孩子{key:[type,vnode]}\n    var oldElements = [] //旧的真实元素\n    var newKeys = {} //新的vnode {key:vnode}\n\n    for (var i = 0; i < oldVnode.children.length; i++) {\n      //循环旧的 vnode，这次循环主要是筛选出带key，可以复用的vnode，最终是{key:[type,vnode]}\n      var oldElement = element.childNodes[i]\n      oldElements[i] = oldElement\n\n      var oldChild = oldVnode.children[i]\n      var oldKey = oldChild.props ? oldChild.props.key : null\n\n      if (null != oldKey) {\n        reusableChildren[oldKey] = [oldElement, oldChild]\n      }\n    }\n\n    var i = 0\n    var j = 0\n\n    while (j < vnode.children.length) {\n      //循环新的node的子节点，循环这个的目的\n      var oldElement = oldElements[i] //这个是一个个 旧的 node 真实节点\n      var oldChild = oldVnode.children[i] //一个个旧的 vnode\n      var newChild = vnode.children[j] //一个个新的vnode\n\n      var oldKey = oldChild.props ? oldChild.props.key : null\n\n      var newKey = newChild.props ? newChild.props.key : null\n\n      var reusableChild = reusableChildren[newKey] || []\n\n      if (null == newKey) {\n        //这种是文字或者数字，直接下一个\n        if (null == oldKey) {\n          patch(element, oldElement, oldChild, newChild)\n          j++\n        }\n        i++\n      } else {\n        if (oldKey === newKey) {\n          //key相同的，如果新旧的key是相同的，就可以复用\n          patch(element, reusableChild[0], reusableChild[1], newChild)\n          i++\n        } else if (reusableChild[0]) {\n          //如果key不同，就在前面插入这个element\n          element.insertBefore(reusableChild[0], oldElement)\n          patch(element, reusableChild[0], reusableChild[1], newChild)\n        } else {\n          patch(element, oldElement, null, newChild)\n        }\n\n        j++\n        newKeys[newKey] = newChild\n      }\n    }\n\n    while (i < oldVnode.children.length) {\n      //这个主要是用于删除的\n      var oldChild = oldVnode.children[i]\n      var oldKey = oldChild.props ? oldChild.props.key : null\n      if (null == oldKey) {\n        element.removeChild(reusableChild[0])\n      }\n      i++\n    }\n\n    for (var i in reusableChildren) {\n      var reusableChild = reusableChildren[i]\n      var reusableNode = reusableChild[1]\n      if (!newKeys[reusableNode.props.key]) {\n        element.removeChild(reusableChild[0])\n      }\n    }\n  } else if (oldVnode !== vnode) {\n    //然后会如果两个对象不同的话就直接替换\n    var i = element\n    parent.replaceChild((element = create(vnode)), i)\n  }\n\n  return element\n}\n\nexport function create(vnode) {\n  if (typeof vnode.type === 'function') {\n    vnode = vnode.type(vnode.props)\n  }\n  let element =\n    typeof vnode === 'string' || typeof vnode === 'number'\n      ? document.createTextNode(vnode)\n      : document.createElement(vnode.type)\n\n  if (vnode.props) {\n    vnode.children.forEach(child => {\n      element.appendChild(create(child))\n    })\n\n    for (let name in vnode.props) {\n      setAttrs(element, name, vnode.props[name])\n    }\n  }\n\n  return element\n}\n\nfunction update(dom, oldProps, props) {\n  let cloneProps = { ...oldProps, ...props }\n  for (let name in cloneProps) {\n    setAttrs(dom, name, cloneProps[name])\n  }\n}\n\nfunction setAttrs(node, name, value) {\n  switch (name) {\n    case String(name.match(/on\\w+/)):\n      name = name.toLowerCase()\n      node[name] = value || ''\n      break\n    case 'className':\n      name === 'class'\n      break\n    case 'key':\n      break\n    case 'value':\n      if (\n        node.tagName.toUpperCase() === 'INPUT' ||\n        node.tagName.toUpperCase() === 'TEXTAREA'\n      ) {\n        node.value = value\n      } else {\n        node.setAttribute(name, value)\n      }\n      break\n    case 'style':\n      node.style.cssText = value\n      break\n    default:\n      node.setAttribute(name, value)\n  }\n}","import { patch } from './patch'\nimport { comp } from './hooks'\n\nlet parent\nlet element\nlet oldVnode\nlet vnode\nexport var comps\n\nexport function render(vdom, el) {\n  comps = filterFn(vdom)\n  parent = el\n  vnode = vdom.type()\n  if (vnode.children) {\n    vnode.children.forEach(child => {\n      const fns = filterFn(child)\n      comps = { ...comps, ...fns }\n    })\n  }\n  rerender()\n}\n\nexport function rerender() {\n  vnode = comp.type(comp.props)\n  \n  setTimeout(() => {\n    element = patch(parent, element, oldVnode, (oldVnode = vnode))\n  })\n}\n\nfunction filterFn(obj) {\n  let fns = {}\n  return walk(obj, fns)\n}\n\nfunction walk(obj, fns) {\n  if (obj) {\n    Object.keys(obj).forEach(i => {\n      if (i === 'type') {\n        let f = obj[i]\n        if (typeof f === 'function') {\n          fns[f.name] = obj\n        }\n      } else if (i === 'children') {\n        let arr = obj[i]\n        arr.forEach(child => {\n          walk(child, fns)\n        })\n      }\n    })\n  }\n  return fns\n}\n","import { rerender, comps } from './render'\n\nlet golbal = {}\nexport var once = true\nexport var comp\n\nexport function useState(state) {\n  if (Object.keys(golbal).length > 0) {\n    state = {\n      ...state,\n      ...golbal\n    }\n  }\n\n  comp = comps['counter']\n  return proxy(state)\n}\n\nfunction proxy(state) {\n  let newState = new Proxy(state, {\n    get(obj, key) {\n      if (golbal[key]) {\n        return golbal[key]\n      } else {\n        return obj[key]\n      }\n    },\n    set(obj, key, val) {\n      golbal[key] = val\n      obj[key] = val\n      rerender()\n      return true\n    }\n  })\n\n  return newState\n}\n\nfunction c() {\n  try {\n    throw new Error()\n  } catch (e) {\n    try {\n      return e.stack.match(/Object.(\\S*)/)[1]\n    } catch (e) {\n      return ''\n    }\n  }\n}\n","// complie tagged template to vnode , thanks htm\n\nconst CACHE = {}\nconst TEMPLATE = document.createElement('template')\nconst reg = /(\\$_h\\[\\d+\\])/g\n\nexport default function html(statics) {\n  const tpl = CACHE[statics] || (CACHE[statics] = build(statics))\n  return tpl(this, arguments)\n}\n\nfunction build(statics) {\n  let str = statics[0],\n    i = 1\n  while (i < statics.length) {\n    str += '$_h[' + i + ']' + statics[i++]\n  }\n  TEMPLATE.innerHTML = str\n    .replace(/<(?:(\\/)\\/|(\\/?)(\\$_h\\[\\d+\\]))/g, '<$1$2c c@=$3')\n    .replace(/<([\\w:-]+)(?:\\s[^<>]*?)?(\\/?)>/g,(str, name, a) => str.replace(/(?:'.*?'|\".*?\"|([A-Z]))/g, (s, c) => (c ? ':::' + c : s)) + (a ? '</' + name + '>' : ''))\n    .replace(/[\\r\\n]|\\ \\ +/g,'')\n    .trim()\n    \n  return Function('h','$_h','return ' + walk((TEMPLATE.content || TEMPLATE).firstChild))\n}\n\nfunction walk(n) {\n  if (n.nodeType != 1) {\n    if (n.nodeType == 3 && n.data) return field(n.data, ',')\n    return 'null'\n  }\n\n  let str = '',\n    nodeName = field(n.localName, str),\n    sub = '',\n    start = ',({'\n\n  for (let i = 0; i < n.attributes.length; i++) {\n    const name = n.attributes[i].name\n    const value = n.attributes[i].value\n\n    if (name == 'c@') {\n      nodeName = value\n    } else if (name.substring(0,3) == '...') {\n      sub = ''\n      start = ',Object.assign({'\n      str += '},' + name.substring(3) + ',{'\n    } else {\n      str += `${sub}\"${name.replace(/:::(\\w)/g, (s, i) => i.toUpperCase())}\":${value ? field(value, '+') : true}`\n      sub = ','\n    }\n  }\n\n  str = 'h(' + nodeName + start + str + '})'\n  let child = n.firstChild\n  while (child) {\n    str += ',' + walk(child)\n    child = child.nextSibling\n  }\n\n  return str + ')'\n}\n\nfunction field(value, sep) {\n  const matches = value.match(reg)\n  let strValue = JSON.stringify(value)\n  \n  if (matches != null) {\n    if (matches[0] === value) return value\n    strValue = strValue.replace(reg, `\"${sep}$1${sep}\"`).replace(/\"[+,]\"/g, '')\n    if (sep == ',') strValue = `[${strValue}]`\n  }\n\n  return strValue\n}\n","import htm from './html'\n\nexport function h(type, props, ...children) {\n  return {\n    type,\n    props,\n    key: props.key || null,\n    children\n  }\n}\n\nexport const html = htm.bind(h)\n","import { useState } from './hooks'\nimport { html, h } from './h'\nimport { render } from './render'\n\nexport { useState, html, h, render }\n","import{ render, html, useState } from './src'\n\nfunction counter() {\n  const state = useState({\n    count: 0\n  })\n\n  return html`\n    <div>\n      ${html`<${count} count=${state.count} />`}\n      <button onclick=${() => {state.count++}}>+</button>\n      <button onclick=${() => {state.count--}}>-</button>\n    </div> \n  `\n}\n\nfunction count(props){\n  const state = useState({\n    sex:'boy'\n  })\n  \n  return html`\n    <div>\n      <p>${props.count}</p>\n      <p>${state.sex}</p>\n      <button onclick=${()=>{state.sex=state.sex==='boy'?'girl':'boy'}}>x</button>\n    </div>\n  `\n}\n\nrender(html`<${counter} />`, document.body)"]}