{"version":3,"sources":["src/patch.js","src/render.js","src/hooks.js","src/html.js","src/h.js","src/index.js","index.js"],"names":["parent","comps","patch","element","oldNode","node","filterFn","insertBefore","create","tag","update","data","reusableChildren","oldElements","newKeys","i","children","length","oldElement","childNodes","oldChild","oldKey","key","j","newChild","newKey","reusableChild","console","log","removeChild","reusableNode","replaceChild","vnode","type","props","dom","document","createElement","name","setAttrs","forEach","child","createTextNode","appendChild","oldProps","cloneProps","value","String","match","toLowerCase","tagName","toUpperCase","setAttribute","style","cssText","obj","fns","walk","Object","keys","f","arr","el","render","rerender","oldVnode","setTimeout","golbal","once","comp","useState","state","c","proxy","newState","Proxy","get","set","val","Error","e","stack","CACHE","TEMPLATE","reg","html","statics","tpl","build","arguments","str","innerHTML","replace","a","s","trim","Function","content","firstChild","n","nodeType","field","nodeName","localName","sub","start","attributes","substring","nextSibling","sep","matches","strValue","JSON","stringify","h","htm","bind","counter","count","body"],"mappings":"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","file":"fre.e31bb0bc.map","sourceRoot":"..","sourcesContent":["//这个方法就是，第一次渲染的时候，parent 是根节点，然后 parent 就变成 element 了\r\nexport let parent, comps\r\nexport function patch(parent, element, oldNode, node) {\r\n  if (oldNode == null) {\r\n    comps = filterFn(node)\r\n    //首次渲染，将node 的 dom 插到 body 下\r\n    element = parent.insertBefore(create(node), element)\r\n  } else if (node.tag && node.tag === oldNode.tag) {\r\n    update(element, oldNode.data, node.data) //更新属性\r\n\r\n    var reusableChildren = {} //可以复用的孩子{key:[type,vnode]}\r\n    var oldElements = [] //旧的真实元素\r\n    var newKeys = {} //新的vnode {key:vnode}\r\n\r\n    for (var i = 0; i < oldNode.children.length; i++) {\r\n      //循环旧的 vnode，这次循环主要是筛选出带key，可以复用的vnode，最终是{key:[type,vnode]}\r\n      var oldElement = element.childNodes[i]\r\n      oldElements[i] = oldElement\r\n\r\n      var oldChild = oldNode.children[i]\r\n      var oldKey = oldChild.data ? oldChild.data.key : null\r\n\r\n      if (null != oldKey) {\r\n        reusableChildren[oldKey] = [oldElement, oldChild]\r\n      }\r\n    }\r\n\r\n    var i = 0\r\n    var j = 0\r\n\r\n    while (j < node.children.length) {\r\n      //循环新的node的子节点，循环这个的目的\r\n      var oldElement = oldElements[i] //这个是一个个 旧的 node 真实节点\r\n      var oldChild = oldNode.children[i] //一个个旧的 vnode\r\n      var newChild = node.children[j] //一个个新的vnode\r\n\r\n      var oldKey = oldChild.data ? oldChild.data.key : null\r\n\r\n      var newKey = newChild.data ? newChild.data.key : null\r\n\r\n      var reusableChild = reusableChildren[newKey] || []\r\n\r\n      if (null == newKey) {\r\n        //这种是文字或者数字，直接下一个\r\n        if (null == oldKey) {\r\n          patch(element, oldElement, oldChild, newChild)\r\n          j++\r\n        }\r\n        i++\r\n      } else {\r\n        if (oldKey === newKey) {\r\n          //key相同的，如果新旧的key是相同的，就可以复用\r\n          patch(element, reusableChild[0], reusableChild[1], newChild)\r\n          i++\r\n        } else if (reusableChild[0]) {\r\n          //如果key不同，就在前面插入这个element\r\n          console.log(element, reusableChild[0], oldElement)\r\n          element.insertBefore(reusableChild[0], oldElement)\r\n          patch(element, reusableChild[0], reusableChild[1], newChild)\r\n        } else {\r\n          patch(element, oldElement, null, newChild)\r\n        }\r\n\r\n        j++\r\n        newKeys[newKey] = newChild\r\n      }\r\n    }\r\n\r\n    while (i < oldNode.children.length) {\r\n      //这个主要是用于删除的\r\n      var oldChild = oldNode.children[i]\r\n      var oldKey = oldChild.data ? oldChild.data.key : null\r\n      if (null == oldKey) {\r\n        element.removeChild(reusableChild[0])\r\n      }\r\n      i++\r\n    }\r\n\r\n    for (var i in reusableChildren) {\r\n      var reusableChild = reusableChildren[i]\r\n      var reusableNode = reusableChild[1]\r\n      if (!newKeys[reusableNode.data.key]) {\r\n        element.removeChild(reusableChild[0])\r\n      }\r\n    }\r\n  } else if (node !== oldNode) {\r\n    //然后会如果两个对象不同的话就直接替换\r\n    var i = element\r\n    parent.replaceChild((element = create(node)), i)\r\n  }\r\n\r\n  parent = element\r\n\r\n  return element\r\n}\r\n\r\nexport function create(vnode) {\r\n  if (typeof vnode.type === 'function') {\r\n    vnode = vnode.type(vnode.props)\r\n  }\r\n  let dom = document.createElement(vnode.type)\r\n  for (let name in vnode.props) {\r\n    setAttrs(dom, name, vnode.props[name])\r\n  }\r\n  vnode.children.forEach(child => {\r\n    child =\r\n      typeof child == 'object' ? create(child) : document.createTextNode(child)\r\n    dom.appendChild(child)\r\n  })\r\n\r\n  return dom\r\n}\r\n\r\nfunction update(dom, oldProps, props) {\r\n  let cloneProps = { ...oldProps, ...props }\r\n  for (let name in cloneProps) {\r\n    setAttrs(dom, name, cloneProps[name])\r\n  }\r\n}\r\n\r\nfunction setAttrs(node, name, value) {\r\n  switch (name) {\r\n    case String(name.match(/on\\w+/)):\r\n      name = name.toLowerCase()\r\n      node[name] = value || ''\r\n      break\r\n    case 'className':\r\n      name === 'class'\r\n      break\r\n    case 'key':\r\n      break\r\n    case 'value':\r\n      if (\r\n        node.tagName.toUpperCase() === 'INPUT' ||\r\n        node.tagName.toUpperCase() === 'TEXTAREA'\r\n      ) {\r\n        node.value = value\r\n      } else {\r\n        node.setAttribute(name, value)\r\n      }\r\n      break\r\n    case 'style':\r\n      node.style.cssText = value\r\n      break\r\n    default:\r\n      node.setAttribute(name, value)\r\n  }\r\n}\r\n\r\nfunction filterFn(obj) {\r\n  let fns = {}\r\n  return walk(obj, fns)\r\n}\r\n\r\nfunction walk(obj, fns) {\r\n  if (obj) {\r\n    Object.keys(obj).forEach(i => {\r\n      if (i === 'type') {\r\n        let f = obj[i]\r\n        if (typeof f === 'function') {\r\n          fns[f.name] = obj\r\n        }\r\n      } else if (i === 'children') {\r\n        let arr = obj[i]\r\n        arr.forEach(child => {\r\n          walk(child, fns)\r\n        })\r\n      }\r\n    })\r\n  }\r\n  return fns\r\n}\r\n","import { patch } from './patch'\r\n\r\nexport let parent\r\nexport let oldNode\r\nexport let el\r\n\r\nexport function render(vnode, el) {\r\n  rerender(el, null, null, vnode)\r\n  el = el\r\n}\r\n\r\nexport function rerender(parent, element, oldVnode, vnode) {\r\n  setTimeout(() => {\r\n    parent = patch(parent, element, oldVnode, (oldNode = vnode))\r\n  })\r\n\r\n}","import { rerender, oldNode, el } from './render'\r\nimport { comps, parent } from './patch'\r\n\r\nlet golbal = {}\r\nlet once = true\r\nlet comp\r\n\r\nexport function useState(state) {\r\n  if (Object.keys(golbal).length > 0) {\r\n    state = {\r\n      ...state,\r\n      ...golbal\r\n    }\r\n  }\r\n\r\n  if (once) {\r\n    comp = comps[c()]\r\n    once = false\r\n  }\r\n  return proxy(state)\r\n}\r\n\r\nfunction proxy(state) {\r\n  let newState = new Proxy(state, {\r\n    get(obj, key) {\r\n      if (golbal[key]) {\r\n        return golbal[key]\r\n      } else {\r\n        return obj[key]\r\n      }\r\n    },\r\n    set(obj, key, val) {\r\n      golbal[key] = val\r\n      obj[key] = val\r\n      rerender(el, parent, oldNode, comp.type())\r\n      return true\r\n    }\r\n  })\r\n\r\n  return newState\r\n}\r\n\r\nfunction c() {\r\n  try {\r\n    throw new Error()\r\n  } catch (e) {\r\n    try {\r\n      return e.stack.match(/Object.(\\S*)/)[1]\r\n    } catch (e) {\r\n      return ''\r\n    }\r\n  }\r\n}\r\n","// complie tagged template to vnode , thanks htm\r\n\r\nconst CACHE = {}\r\nconst TEMPLATE = document.createElement('template')\r\nconst reg = /(\\$_h\\[\\d+\\])/g\r\n\r\nexport default function html(statics) {\r\n  const tpl = CACHE[statics] || (CACHE[statics] = build(statics))\r\n  return tpl(this, arguments)\r\n}\r\n\r\nfunction build(statics) {\r\n  let str = statics[0],\r\n    i = 1\r\n  while (i < statics.length) {\r\n    str += '$_h[' + i + ']' + statics[i++]\r\n  }\r\n  TEMPLATE.innerHTML = str\r\n    .replace(/<(?:(\\/)\\/|(\\/?)(\\$_h\\[\\d+\\]))/g, '<$1$2c c@=$3')\r\n    .replace(/<([\\w:-]+)(?:\\s[^<>]*?)?(\\/?)>/g,(str, name, a) => str.replace(/(?:'.*?'|\".*?\"|([A-Z]))/g, (s, c) => (c ? ':::' + c : s)) + (a ? '</' + name + '>' : ''))\r\n    .replace(/[\\r\\n]|\\ \\ +/g,'')\r\n    .trim()\r\n\r\n  return Function('h','$_h','return ' + walk((TEMPLATE.content || TEMPLATE).firstChild))\r\n}\r\n\r\nfunction walk(n) {\r\n  if (n.nodeType != 1) {\r\n    if (n.nodeType == 3 && n.data) return field(n.data, ',')\r\n    return 'null'\r\n  }\r\n\r\n  let str = '',\r\n    nodeName = field(n.localName, str),\r\n    sub = '',\r\n    start = ',({'\r\n\r\n  for (let i = 0; i < n.attributes.length; i++) {\r\n    const name = n.attributes[i].name\r\n    const value = n.attributes[i].value\r\n\r\n    if (name == 'c@') {\r\n      nodeName = value\r\n    } else if (name.substring(0,3) == '...') {\r\n      sub = ''\r\n      start = ',Object.assign({'\r\n      str += '},' + name.substring(3) + ',{'\r\n    } else {\r\n      str += `${sub}\"${name.replace(/:::(\\w)/g, (s, i) => i.toUpperCase())}\":${value ? field(value, '+') : true}`\r\n      sub = ','\r\n    }\r\n  }\r\n\r\n  str = 'h(' + nodeName + start + str + '})'\r\n  let child = n.firstChild\r\n  while (child) {\r\n    str += ',' + walk(child)\r\n    child = child.nextSibling\r\n  }\r\n\r\n  return str + ')'\r\n}\r\n\r\nfunction field(value, sep) {\r\n  const matches = value.match(reg)\r\n  let strValue = JSON.stringify(value)\r\n  \r\n  if (matches != null) {\r\n    if (matches[0] === value) return value\r\n    strValue = strValue.replace(reg, `\"${sep}$1${sep}\"`).replace(/\"[+,]\"/g, '')\r\n    if (sep == ',') strValue = `[${strValue}]`\r\n  }\r\n\r\n  return strValue\r\n}\r\n","import htm from './html'\r\n\r\nexport function h(type, props, ...children) {\r\n  return {\r\n    type,\r\n    props,\r\n    key: props.key || null,\r\n    children\r\n  }\r\n}\r\n\r\nexport const html = htm.bind(h)\r\n","import { useState } from './hooks'\r\nimport { html, h } from './h'\r\nimport { render } from './render'\r\n\r\nexport { useState, html, h, render }\r\n","import { render, html, useState } from './src'\r\n\r\nfunction counter() {\r\n  const state = useState({\r\n    count: 0\r\n  })\r\n\r\n  console.log(state)\r\n\r\n  return html`\r\n    <div>\r\n      <p>${state.count}</p>\r\n      <button onclick=${() => {state.count++}}>+</button>\r\n      <button onclick=${() => {state.count--}}>-</button>\r\n    </div>\r\n  `\r\n}\r\n\r\nrender(html`<${counter} />`, document.body)"]}