{"version":3,"sources":["src\\html.js","src\\h.js","index.js"],"names":["html","CACHE","TEMPLATE","document","createElement","reg","statics","tpl","build","arguments","str","i","length","innerHTML","replace","name","a","s","c","trim","Function","walk","content","firstChild","n","nodeType","data","field","nodeName","localName","sub","start","attributes","value","substring","toUpperCase","child","nextSibling","sep","matches","match","strValue","JSON","stringify","h","type","props","children","bind","oldDom","newDom","console","log"],"mappings":"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","file":"fre1.a087753c.map","sourcesContent":["// complie tagged template to vnode , thanks htm\r\n\r\nconst CACHE = {}\r\nconst TEMPLATE = document.createElement('template')\r\nconst reg = /(\\$_h\\[\\d+\\])/g\r\n\r\nexport function html(statics) {\r\n  const tpl = CACHE[statics] || (CACHE[statics] = build(statics))\r\n  return tpl(this, arguments)\r\n}\r\n\r\nfunction build(statics) {\r\n  let str = statics[0],\r\n    i = 1\r\n  while (i < statics.length) {\r\n    str += '$_h[' + i + ']' + statics[i++]\r\n  }\r\n  TEMPLATE.innerHTML = str\r\n    .replace(/<(?:(\\/)\\/|(\\/?)(\\$_h\\[\\d+\\]))/g, '<$1$2c c@=$3')\r\n    .replace(/<([\\w:-]+)(?:\\s[^<>]*?)?(\\/?)>/g,(str, name, a) => str.replace(/(?:'.*?'|\".*?\"|([A-Z]))/g, (s, c) => (c ? ':::' + c : s)) + (a ? '</' + name + '>' : ''))\r\n    .trim()\r\n\r\n  return Function('h','$_h','return ' + walk((TEMPLATE.content || TEMPLATE).firstChild))\r\n}\r\n\r\nfunction walk(n) {\r\n  if (n.nodeType != 1) {\r\n    if (n.nodeType == 3 && n.data) return field(n.data, ',')\r\n    return 'null'\r\n  }\r\n\r\n  let str = '',\r\n    nodeName = field(n.localName, str),\r\n    sub = '',\r\n    start = ',({'\r\n\r\n  for (let i = 0; i < n.attributes.length; i++) {\r\n    const name = n.attributes[i].name\r\n    const value = n.attributes[i].value\r\n\r\n    if (name == 'c@') {\r\n      nodeName = value\r\n    } else if (name.substring(0,3) == '...') {\r\n      sub = ''\r\n      start = ',Object.assign({'\r\n      str += '},' + name.substring(3) + ',{'\r\n    } else {\r\n      str += `${sub}\"${name.replace(/:::(\\w)/g, (s, i) => i.toUpperCase())}\":${value ? field(value, '+') : true}`\r\n      sub = ','\r\n    }\r\n  }\r\n\r\n  str = 'h(' + nodeName + start + str + '})'\r\n  let child = n.firstChild\r\n  while (child) {\r\n    if(child.nodeName !== '#text'){\r\n      str += ',' + walk(child)\r\n      child = child.nextSibling\r\n    }\r\n  }\r\n\r\n  return str + ')'\r\n}\r\n\r\nfunction field(value, sep) {\r\n  const matches = value.match(reg)\r\n  let strValue = JSON.stringify(value)\r\n  \r\n  if (matches != null) {\r\n    if (matches[0] === value) return value\r\n    strValue = strValue.replace(reg, `\"${sep}$1${sep}\"`).replace(/\"[+,]\"/g, '')\r\n    if (sep == ',') strValue = `[${strValue}]`\r\n  }\r\n\r\n  return strValue\r\n}\r\n","import { html } from './html'\r\n\r\nexport function h(type, props, ...children) {\r\n  return { type, props, children }\r\n}\r\n\r\nexport default html.bind(h)\r\n","import html from './src/h'\r\n\r\nlet oldDom = html`\r\n  <ul class=\"list\">\r\n    <li class=\"item\">1</li>\r\n    <li class=\"item\">2</li>\r\n    <li class=\"item\">3</li>\r\n  </ul>\r\n`\r\n\r\nlet newDom = html`\r\n  <ul class=\"list\">\r\n    <li class=\"item\">2</li>\r\n    <li class=\"item\">3</li>\r\n    <li class=\"item\">4</li>\r\n  </ul>\r\n`\r\n\r\n\r\nconsole.log(oldDom,newDom)"]}